<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Forged by the Fox</title>
    <th:block th:replace="~{fragment/core :: meta}" />
    <th:block th:replace="~{fragment/core :: stylesheets}" />
    <th:block th:replace="~{fragment/core :: pwa}" />

    <style>
        main {
            display: flex;
            flex-direction: row;
            flex-wrap: nowrap;
            justify-content: start;
            align-items: stretch;
        }

        .character-sheet {
            flex: 1 100%;
            display: grid;
            grid-template-columns: 5fr 5fr 2fr;
            margin: 0 auto;
            max-width: 110rem;
            gap: 2rem;
            padding: 1rem;

            background: var(--fbtf-palette-black-regular);
        }

        @media (max-width: 60rem) {
            .character-sheet {
                grid-template-columns: 3fr 2fr;
            }

            .character-sheet div:first-child {
                grid-column: span 2;
            }
        }

        @media (max-width: 38rem) {
            .character-sheet {
                grid-template-columns: 1fr;
            }

            .character-sheet div:first-child {
                grid-column: span 1;
            }

            .character-sheet > .attributes {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 0.5rem;
            }

            main > aside {
                display: none;
            }
        }

    </style>
</head>
<body>
<th:block th:replace="~{component/global-header :: root}" />
<main th:with="_campaign=${ctx.character.campaignIdentifier ? service.campaigns.fetch.withIdentifier(ctx.character.campaignIdentifier).get : _}">
    <th:block th:if="${_campaign}">
        <th:block th:replace="~{component/campaign-sidebar :: root(${_campaign}, ${ctx.account})}" />
    </th:block>
<div class="character-sheet">
    <!-- Character details -->
    <div>
        <th:block th:replace="~{layout/labeled-container :: root(label=${ctx.character.playbook.label} + ' Playbook', content=~{:: #character-details})}">
            <div id="character-details" th:hx-get="'/fragments/characters/' + ${ctx.character.identifier} + '/details'" hx-trigger="load" hx-replace="outerHTML"><th:block th:replace="~{component/loading-indicator :: root }" /></div>
        </th:block>
    </div>

    <!-- Abilities -->
    <div>
        <th:block th:replace="~{layout/labeled-container :: root(label='Special Abilities', content=~{:: #character-abilities})}">
            <div id="character-abilities" th:hx-get="'/fragments/characters/' + ${ctx.character.identifier} + '/abilities'" hx-trigger="load" hx-replace="outerHTML"><th:block th:replace="~{component/loading-indicator :: root }" /></div>
        </th:block>
    </div>

    <!-- Actions & Attributes -->
    <div class="attributes">
        <th:block th:each="attribute : ${ctx.attributes}">
            <th:block th:replace="~{component/attribute-display :: root(${ctx.character}, ${attribute})}" />
        </th:block>
        <th:block th:replace="~{layout/labeled-container :: root(label='Bonus Dice', content=~{:: #character-bonus-dice})}">
            <ul id="character-bonus-dice" style="padding: 0.0625rem;">
                <li style="margin: 0.125rem;border: 1px solid white;padding: 0.5rem 1rem;">
                    <p><strong style="text-decoration:underline;font-weight:bolder">Push yourself</strong> (take 2 stress) <strong style="white-space:nowrap;">-or-</strong> accept a <strong style="text-decoration:underline;font-weight:bolder">Devil's Bargain</strong></p>
                </li>

                <li style="margin: 0.125rem;border: 1px solid white;padding: 0.5rem 1rem;">
                    <p><strong style="text-decoration:underline;font-weight:bolder">Assist</strong> (they take 1 stress)</p>
                </li>

                <li style="margin: 0.125rem;border: 1px solid white;padding: 0.5rem 1rem;">
                    <p><strong style="text-decoration:underline;font-weight:bolder">Spend a Gambit</strong></p>
                </li>
            </ul>
        </th:block>
    </div>
</div>

</main>
</body>
</html>